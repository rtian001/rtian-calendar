<!DOCTYPE html>
<html lang="zh-CN">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link rel="stylesheet" href="rtianCalendar.css">
        <script src="rtianCalendar.js"></script>
    </head>

    <body>
        <div id="calendar"></div>
        <div id="res"></div>
        <script>
            const resdom = document.querySelector('#res');
            const calender = new rtianCalender('#calendar').render({ showPublicHoliday: false, width: 500, height: 600 });
            var holiday = {}

            //模拟异步获取自定义节假日
            async function getHolidays(ym) {
                let count = ~~(Math.random() * 5 + 3)
                let arr = []
                for (let i = 0; i < count; i++) {
                    let d = ~~(Math.random() * 28 + 1)
                    arr.push(`${ym}-${d.toString().padStart(2, '0')}`)
                }
                arr = [...new Set(arr)]
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        resolve(arr)
                    }, 0);
                })
            }
            //获取指定月份节假日，并渲染到日历
            getHolidays('2025-06').then(data => {
                calender.renderMaker('2025-06-10,2025-06-22');
            })

            //自定义事件：切换月份时，获取当前月份的节假日，并渲染到日历
            calender.change = function (date) {
                let ym = date.slice(0, 7)
                getHolidays(ym).then(data => {
                    calender.renderMaker(data);
                })
                //其他代码
                resdom.innerHTML = 'change事件:切换到' + date;
            }
            //自定义事件：切换到指定日期
            calender.done = function (date) {
                resdom.innerHTML = 'done事件:切换到' + date;
            }



            //=============================================测试排班
            let arr = ['周日', '周一', '周二', '周三', '周四', '周五', '周六']
            let startvalue = 3;
            let start = startvalue - 1;
            let newarr = arr.slice(start).concat(arr.slice(0, start))
            let days = calender.days;
            let idx = 0
            days.forEach(day => {
                if (day.classList.contains('cday')) {
                    day.innerHTML += '<br>' + newarr[idx];
                    idx++;
                    idx = idx % 7
                    if (idx % 7 == 0) {
                        console.log('day:', newarr)
                        newarr = newarr.slice(start).concat(newarr.slice(0, start))
                    }
                }
            })
            console.log('newarr:', newarr)
            console.log(idx, idx % 7);
            idx = idx % 7
            let lastarr = newarr.slice(start).concat(newarr.slice(0, start))
            console.log(lastarr)
            // calender.render({
            //     width: 500,
            //     height: 600
            // })
        </script>
    </body>

</html>